<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=1000, initial-scale=1.0">
  <title>D3.js</title>
  <script src="https://d3js.org/d3.v6.min.js"></script>
</head>

<style>
  body, html {
    margin: 0;
    padding: 0;
    height: 100%;
  }

  #visualization {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
  }
</style>

<body>
  <div id="visualization"></div>
  <script>
  console.log(d3); // test if d3 is loaded
  
  // Select the container
  const container = d3.select("#visualization");
  
  // Set the background color of the container
  container.style("background-color", "orange");

  // Append an SVG element to the container
  const svg = container
    .append("svg")
    .attr("width", 1000)
    .attr("height", 1000);

  // Adding text
  svg
    .append("text")
    .attr("x", 300) // Adjust the x-coordinate for positioning from the right
    .attr("y", 100) // Adjust the y-coordinate for positioning from the top
    .attr("text-anchor", "end") // Set the text anchor to end for right alignment
    .attr("fill", "Black") // Set the text color
    .attr("font-weight", "bold") // Make the text bold
    .attr("font-size", "20px") // Set the font size
    .text("Assignment 1 - Summer Evening"); // Set the text content

  // Adding Sun/Moon (Circle)
  // Center Circle
  const centerX = svg.attr("width") / 2;
  const centerY = svg.attr("height") / 2;

  svg
    .append("circle")
    .attr("cx", centerX)
    .attr("cy", centerY)
    .attr("r", 400)
    .attr("fill", "url(#sunGradient)");

  // Adding Birds (Lines)
  const radius = 35;

  const lineData = [
    { x: 0, y: -radius },                   
    { x: radius / Math.sqrt(2), y: -radius / Math.sqrt(2) }, 
    { x: radius, y: -radius } 
  ];

  const lineGenerator = d3.line()
    .x(d => d.x)
    .y(d => d.y)
    .curve(d3.curveBasis);

  const reflectedLineData = lineData.map(point => ({ x: -point.x, y: point.y }));

  // row 1 bird 1
  svg
    .append("path")
    .attr("d", lineGenerator(lineData))
    .attr("transform", `translate(${svg.attr("width") / 1.2}, ${svg.attr("height") / 5})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  svg
    .append("path")
    .attr("d", lineGenerator(reflectedLineData))
    .attr("transform", `translate(${svg.attr("width") / 1.2}, ${svg.attr("height") / 5})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  // row 2 bird 1
  svg
    .append("path")
    .attr("d", lineGenerator(lineData))
    .attr("transform", `translate(${svg.attr("width") / 1.3}, ${svg.attr("height") / 4.3})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  svg
    .append("path")
    .attr("d", lineGenerator(reflectedLineData))
    .attr("transform", `translate(${svg.attr("width") / 1.3}, ${svg.attr("height") / 4.3})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  // row 2 bird 2
  svg
    .append("path")
    .attr("d", lineGenerator(lineData))
    .attr("transform", `translate(${svg.attr("width") / 1.1}, ${svg.attr("height") / 4.3})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  svg
    .append("path")
    .attr("d", lineGenerator(reflectedLineData))
    .attr("transform", `translate(${svg.attr("width") / 1.1}, ${svg.attr("height") / 4.3})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  // row 3 bird 1
  svg
    .append("path")
    .attr("d", lineGenerator(lineData))
    .attr("transform", `translate(${svg.attr("width") / 1.4}, ${svg.attr("height") / 3.6})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  svg
    .append("path")
    .attr("d", lineGenerator(reflectedLineData))
    .attr("transform", `translate(${svg.attr("width") / 1.4}, ${svg.attr("height") / 3.6})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  // row 3 bird 2
  svg
    .append("path")
    .attr("d", lineGenerator(lineData))
    .attr("transform", `translate(${svg.attr("width") / 1.2}, ${svg.attr("height") / 3.6})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  svg
    .append("path")
    .attr("d", lineGenerator(reflectedLineData))
    .attr("transform", `translate(${svg.attr("width") / 1.2}, ${svg.attr("height") / 3.6})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  // row 3 bird 3
  svg
    .append("path")
    .attr("d", lineGenerator(lineData))
    .attr("transform", `translate(${svg.attr("width") / 1.05}, ${svg.attr("height") / 3.6})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  svg
    .append("path")
    .attr("d", lineGenerator(reflectedLineData))
    .attr("transform", `translate(${svg.attr("width") / 1.05}, ${svg.attr("height") / 3.6})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  // row 4 bird 1
  svg
    .append("path")
    .attr("d", lineGenerator(lineData))
    .attr("transform", `translate(${svg.attr("width") / 1.5}, ${svg.attr("height") / 3.1})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  svg
    .append("path")
    .attr("d", lineGenerator(reflectedLineData))
    .attr("transform", `translate(${svg.attr("width") / 1.5}, ${svg.attr("height") / 3.1})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  // row 4 bird 2
  svg
    .append("path")
    .attr("d", lineGenerator(lineData))
    .attr("transform", `translate(${svg.attr("width") / 1.3}, ${svg.attr("height") / 3.1})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  svg
    .append("path")
    .attr("d", lineGenerator(reflectedLineData))
    .attr("transform", `translate(${svg.attr("width") / 1.3}, ${svg.attr("height") / 3.1})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  // row 4 bird 3
  svg
    .append("path")
    .attr("d", lineGenerator(lineData))
    .attr("transform", `translate(${svg.attr("width") / 1.1}, ${svg.attr("height") / 3.1})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  svg
    .append("path")
    .attr("d", lineGenerator(reflectedLineData))
    .attr("transform", `translate(${svg.attr("width") / 1.1}, ${svg.attr("height") / 3.1})`)
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr("fill", "none");

  // Adding building (rectangles)
  svg
    .append("rect")
    .attr("x", 0)
    .attr("y", 500)
    .attr("width", 225)
    .attr("height", 500)
    .attr("fill", "grey");

  svg
    .append("rect")
    .attr("x", 250)
    .attr("y", 400)
    .attr("width", 225)
    .attr("height", 600)
    .attr("fill", "grey");

  svg
    .append("rect")
    .attr("x", 500)
    .attr("y", 375)
    .attr("width", 225)
    .attr("height", 625)
    .attr("fill", "grey");

  svg
    .append("rect")
    .attr("x", 750)
    .attr("y", 600)
    .attr("width", 225)
    .attr("height", 400)
    .attr("fill", "grey");


  // Adding a long pentagon
  const pentagonPoints = [
    { x: 250, y: 400 },
    { x: 475, y: 400 },
    { x: 475, y: 300 },
    { x: 362.5, y: 200 },
    { x: 250, y: 300 }
  ];

  svg
    .append("polygon")
    .attr("points", pentagonPoints.map(point => `${point.x},${point.y}`).join(" "))
    .attr("fill", "grey")
  

  // Add the linear gradient definition
  svg.append("defs")
      .append("linearGradient")
      .attr("id", "sunGradient")
      .attr("x1", "0%")
      .attr("y1", "0%")
      .attr("x2", "100%")
      .attr("y2", "0%")
      .selectAll("stop")
      .data([
        { offset: "0%", color: "yellow" },
        { offset: "25%", color: "orange" },
        { offset: "50%", color: "white" },
        { offset: "75%", color: "orange" },
        { offset: "100%", color: "yellow" }
      ])
      .enter().append("stop")
      .attr("offset", d => d.offset)
      .attr("stop-color", d => d.color);

  // Function to update gradient stops over time
  function updateGradient() {
    const gradientStops = svg.select("#sunGradient").selectAll("stop");

  // Update saturation based on time
    const currentTime = new Date().getTime();
    const saturation = 50 + Math.sin((currentTime / 100) * 2 * Math.PI) * 50; // Vary saturation over time

  // Apply the same color with varying saturation to all stops
    const color = `hsl(50, ${saturation}%, 50%)`;
    gradientStops.each(function() {
      d3.select(this).attr("stop-color", color);
    });

  // Update background color based on time for the container
    const containerSaturation = 40 + Math.sin((currentTime / 100) * 2 * Math.PI) * 50; // Vary saturation over time for the background
    const containerColor = `hsl(30, ${containerSaturation}%, 40%)`;
    container.style("background-color", containerColor);

  // Update building colors based on time
    const buildingSaturation = 15 + Math.sin((currentTime / 100) * 2 * Math.PI) * 30; // Vary saturation over time for the buildings
    const buildingColor = `hsl(0, 0%, ${buildingSaturation}%)`;

  // Select and update each building
    svg.selectAll("rect")
    .attr("fill", buildingColor);

  // Select and update top building
    svg.selectAll("polygon")
    .attr("fill", buildingColor);

  // Repeat the update at a certain interval
    setTimeout(updateGradient, 200);
}
  // Call the function to start the dynamic color change
  updateGradient();

  // Add an SVG (container)
  // Add Rectangles (buildings)
  // Add Circles (sun/moon)
  // Add Lines (birds)
  // Add Polygons
  </script>
</body>


<!-- // Animation: Rotate the lines in opposite directions
    function rotateLines() {
      bird1.transition()
        .duration(1000)
        .attrTween("transform", counterclockwiseRotateTween)
        .on("end", rotateLines);

      bird1.transition()
        .duration(1000)
        .attrTween("transform", clockwiseRotateTween)
        .on("end", rotateLines);

      bird2.transition()
        .duration(1000)
        .attrTween("transform", clockwiseRotateTween)
        

      bird2.transition()
        .duration(1000)
        .attrTween("transform", counterclockwiseRotateTween)
        .on("end", rotateLines);
    }

    function clockwiseRotateTween() {
      const i = d3.interpolate(0, 10); // Rotate clockwise 360 degrees
      return t => `rotate(${i(t)}, 0, 0)`;
    }

    function counterclockwiseRotateTween() {
      const i = d3.interpolate(0, -10); // Rotate counterclockwise 360 degrees
      return t => `rotate(${i(t)}, 0, 0)`;
    }

    // Start the rotation animation
    rotateLines(); -->